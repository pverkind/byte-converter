<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Binary & UTF-8 Converter</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; }
        textarea, button { margin: 10px; padding: 10px; font-size: 16px; }
        canvas { border: 1px solid black; margin-top: 20px; }
        .output { margin-top: 20px; font-size: 18px; }
        textarea { width: 80%; min-height: 50px; resize: none; }
    </style>
</head>
<body onload="loadFromURL()">
    <h2>Binary & UTF-8 Converter</h2>
    <h2>(Entirely generated by ChatGPT!)</h2>
    <textarea id="inputField" placeholder="Enter binary or text" oninput="updateButtonLabel(); adjustTextareaHeight();"></textarea>
    <br>
    <button id="convertTextButton" onclick="convertText()">Convert to Text</button>
    <button onclick="convertToDecimal()">Convert to Decimal</button>
    <button onclick="convertToColor()">Convert to Color</button>
    
    <div id="output" class="output"></div>
    <canvas id="colorCanvas"></canvas>

    <script>
        function isBinary(input) {
            return /^[01]+$/.test(input);
        }

        function binaryToText(binary) {
            return binary.match(/.{8}/g).map(byte => String.fromCharCode(parseInt(byte, 2))).join('');
        }

        function textToBinary(text) {
            return Array.from(new TextEncoder().encode(text))
                .map(byte => byte.toString(2).padStart(8, '0'))
                .join('');
        }

        function binaryToDecimal(binary) {
            return binary.match(/.{8}/g).map(byte => parseInt(byte, 2)).join(', ');
        }

        function binaryToRGB(binary) {
            while (binary.length % 24 !== 0) {
                binary += '0';
            }
            let colors = [];
            for (let i = 0; i < binary.length; i += 24) {
                let r = parseInt(binary.slice(i, i + 8), 2);
                let g = parseInt(binary.slice(i + 8, i + 16), 2);
                let b = parseInt(binary.slice(i + 16, i + 24), 2);
                colors.push([r, g, b]);
            }
            return colors;
        }

        function drawColorGrid(colors, blockSize = 20) {
            let numBlocks = colors.length;
            let size = Math.ceil(Math.sqrt(numBlocks));
            let canvas = document.getElementById("colorCanvas");
            let ctx = canvas.getContext("2d");
            canvas.width = size * blockSize;
            canvas.height = size * blockSize;

            for (let i = 0; i < numBlocks; i++) {
                let x = (i % size) * blockSize;
                let y = Math.floor(i / size) * blockSize;
                ctx.fillStyle = `rgb(${colors[i][0]}, ${colors[i][1]}, ${colors[i][2]})`;
                ctx.fillRect(x, y, blockSize, blockSize);
            }
        }

        function convertText() {
            let input = document.getElementById("inputField").value.trim();
            if (isBinary(input)) {
                document.getElementById("output").innerText = "Text: " + binaryToText(input);
            } else {
                document.getElementById("output").innerText = "Binary: " + textToBinary(input);
            }
        }

        function convertToDecimal() {
            let input = document.getElementById("inputField").value.trim();
            if (isBinary(input)) {
                document.getElementById("output").innerText = "Decimal: " + binaryToDecimal(input);
            } else {
                let binary = textToBinary(input);
                document.getElementById("output").innerText = "Decimal: " + binaryToDecimal(binary);
            }
        }

        function convertToColor() {
            let input = document.getElementById("inputField").value.trim();
            let binaryString = isBinary(input) ? input : textToBinary(input);
            let colors = binaryToRGB(binaryString);
            drawColorGrid(colors);
        }

        function updateButtonLabel() {
            let input = document.getElementById("inputField").value.trim();
            let button = document.getElementById("convertTextButton");
            if (isBinary(input)) {
                button.innerText = "Convert to Text";
            } else {
                button.innerText = "Convert to Binary";
            }
        }

        function loadFromURL() {
            const urlParams = new URLSearchParams(window.location.search);
            const inputText = urlParams.get('input');
            if (inputText) {
                document.getElementById("inputField").value = decodeURIComponent(inputText);
                updateButtonLabel();
                adjustTextareaHeight();
            }
        }

        function adjustTextareaHeight() {
            let textarea = document.getElementById("inputField");
            textarea.style.height = "auto";
            textarea.style.height = (textarea.scrollHeight) + "px";
        }
    </script>
</body>
</html>
